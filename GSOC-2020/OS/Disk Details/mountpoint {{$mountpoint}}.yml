groups:
- name: mountpoint {{ $mountpoint}} 
  rules:
  - alert: Mountpoint usage close to 100%
    expr: avg by (node_name,mountpoint) (1 - (max_over_time(node_filesystem_free_bytes{node_name=~\"$node_name\", 
    fstype!~\"rootfs|selinuxfs|autofs|rpc_pipefs|tmpfs\"}[$interval]) or 
    max_over_time(node_filesystem_free_bytes{node_name=~\"$node_name\", 
    fstype!~\"rootfs|selinuxfs|autofs|rpc_pipefs|tmpfs\"}[5m])) /
    \n(max_over_time(node_filesystem_size_bytes{node_name=~\"$node_name\", fstype!~\"rootfs|selinuxfs|autofs|rpc_pipefs|tmpfs\"}[$interval])
    or\nmax_over_time(node_filesystem_size_bytes{node_name=~\"$node_name\", 
    fstype!~\"rootfs|selinuxfs|autofs|rpc_pipefs|tmpfs\"}[5m]))) > th
    for: 5m
    labels:
      severity: error
    annotations:
      summary: "Disk space utilization by (instance {{ $mountpoint }}) close to 100 %"
      
